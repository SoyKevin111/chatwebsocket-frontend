<!-- Chat Room -->
<div *ngIf="isConnected" class="d-flex flex-column vh-100 bg-dark text-light">
	<!-- Header -->
	<header class="bg-secondary p-3 text-center shadow-sm">
		<h2 class="mb-0">Chat Room</h2>
	</header>

	<!-- Messages -->
	<ul class="list-unstyled flex-grow-1 overflow-auto p-3 mb-0" style="background-color: #1c1c1c;">
		<li *ngFor="let message of messages" class="mb-3">

			<!-- Mensajes normales -->
			<div *ngIf="message.type==='CHAT'" class="d-flex align-items-start"
				[ngClass]="{'flex-row-reverse text-end': message.sender === username}">

				<!-- Avatar -->
				<div class="rounded-circle text-center text-light fw-bold me-2"
					[style.backgroundColor]="getAvatarColor(message.sender)"
					style="width: 40px; height: 40px; line-height: 40px; font-size: 1.1rem;"
					[ngClass]="{'ms-3 me-3': message.sender === username}">
					{{message.sender.charAt(0)}}
				</div>

				<!-- Message -->
				<div [ngClass]="{'text-end': message.sender === username}">
					<small class="text-white fw-bold">
						{{message.sender}}
						<span *ngIf="message.sender === username">(You)</span>
					</small>
					<p class="mb-0 p-2 rounded shadow-sm text-white"
						[ngStyle]="{'background-color': message.sender === username ? '#0d6efd' : '#333333'}">
						{{message.content}}
					</p>
				</div>
			</div>

			<!-- Mensajes de eventos (JOIN / LEAVE) -->
			<div *ngIf="message.type !== 'CHAT'" class="text-center my-2">
				<p class="text-white-50 fst-italic small mb-0">
					{{message.sender}} {{message.type === 'JOIN' ? 'joined!' : 'left!'}}
				</p>
			</div>

		</li>
	</ul>



	<!-- Input -->
	<form (ngSubmit)="sendMessage()" class="p-3 border-top border-secondary">
		<div class="input-group">
			<input [(ngModel)]="message" name="message" type="text" class="form-control form-control-lg"
				placeholder="Type a message..." required>
			<button type="submit" class="btn btn-primary">
				<i class="fa-solid fa-paper-plane"></i>
			</button>
		</div>
	</form>
</div>